{"./":{"url":"./","title":"Introduction","keywords":"","body":"This is a book powered by GitBook. "},"前言.html":{"url":"前言.html","title":"前言","keywords":"","body":"前言 在大约二十年之前，在我撰写《因果》这本书的前言的时候，我在里面提出了一个大胆的想法，以至于朋友们都说让我冷静冷静：“‘因果’这个概念正在经历一次重要的转变。从一个笼罩着神秘面纱的东西转变成为具有明确语义和良好逻辑的数学对象，种种问题和争议得到了解决，难以捉摸的概念得到了解释，长期以来被认为是形而上学的或难以处理的依赖因果信息的实际问题，现在可以用初等数学来解决了。简单地说，因果关系已经被数学化了。” 今天再读到这篇文章，我觉得我有些短视。我当时所描述的“转变”结果成为了改变了许多科学思想的“革命”。现在，许多人称其为“因果革命”，它在研究界引起的浪潮正在蔓延到教育和应用领域。我相信现在是时候与更多的读者和群众分享它了。 这本书致力于完成三个方面的任务:首先，用非数学的语言向您展示因果革命的知识内容以及它是如何影响我们的生活和未来的;其次，向你们介绍一些在此基础上的伟大工作，无论是成功的还是失败的，这些都是科学家们开始面对并着手研究的严峻的因果问题。 最后，我们将重回最初孕育“因果革命”的人工智能研究中，我的目标是向你们描述如何制造出能够学会用我们的母语——因果语言——交流的机器人。新一代的机器人应该向我们解释为什么事情会发生，为什么它们会这样反应，以及为什么大自然是这样运作的而不是另一种。甚至还有更大的野心，他们还应该让我们了解自己:为什么我们的头脑会这样有条不紊的运行；理性地思考因果关系、信任与背叛、目的与责任这些东西意味着什么。 当我写方程式时，我非常清楚我的读者是谁。但当我为大众写作时，就不是这样了——这对我来说是一种全新的冒险。很奇怪，但这是我一生中最有回报的一次教育之旅。用你的语言塑造你的思想，猜测你的背景，你的问题和你的反应，比我写这本书之前写的所有方程式更能强化我对因果关系的理解。 Judea PearlLos Angeles, October 2017 "},"序章.html":{"url":"序章.html","title":"序章","keywords":"","body":"序章 每一个蓬勃发展的科学都有自己的符号 --AUGUSTUS DE MORGAN (1864) 这本书讲述了关于一门科学的故事，这门科学改变了我们将事实与幻想区分开的方式，但仍然受到普通大众的关注。这门科学的发展和结论已经影响到我们生活中许多关键的方面，并仍在扩大，从开发新药到控制经济政策，从教育和机器人技术到控制枪支和全球变暖。值得注意的是，尽管这些问题领域具有多样性和明显的不互通，但新科学将它们全部纳入了一个统一的框架，而二十年前实际上是不存在的。 新科学并没有花哨的名字：我和许多同事一样，将其简称为“因果推论”。它也不是特别高科技。最理想的因果推论就是尽可能的去模仿我们自己的思维。在几万年前，人类开始意识到某些事物会导致其他事物，而修补前者可以改变后者。没有其他物种能够像我们一样做到这一点。这一发现产生了有组织的社会，然后是城镇和城市，最后是我们今天享受的基于科学和技术的文明。所有这些都是因为我们问了一个简单的问题：为什么？ 因果推断就是认真对待这个问题。它假定人脑是有史以来用于管理因果关系的最先进的工具。我们的大脑存储了数量惊人的因果知识，再加上数据，我们可以利用它来回答我们这个时代最紧迫的问题。更雄心勃勃的是，一旦我们真正理解了因果思维背后的逻辑，就可以在现代计算机上模仿它，并创建一个“人工科学家”。这款智能机器人将发现未知现象，找到待解决的科学难题的解释，设计新的实验，并不断从环境中提取更多因果知识。 但是，在我们胡扯的推测这种未来发展之前，了解因果推论迄今已取得的成就非常重要。我们将探讨它几乎改变了所有数据信息学科中的科学家思维的方式，以及它将如何改变我们的生活。 新科学解决了这些看似简单的问题: 一种特定的治疗方法对预防疾病的效果如何？ 是新税法导致了我们销售额的上升，还是我们的广告宣传？ 肥胖造成的医疗保健费用是多少? 雇佣记录能否证明雇主违反了性别歧视政策？ 我想辞职了，我做的对吗？ 这些问题都与因果关系有关，可以通过诸如“预防”、“原因”、“归因于”、“政策”和“我应该吗”这样的词来识别。这些词在日常语言中很常见，而我们的社会不断地要求这些问题的答案。然而，直到最近，科学还没有给我们任何方法来表达它们，更不用说回答了。 到目前为止，因果推理对人类最重要的贡献就是把这种对科学的忽视变成了过去。这门新的科学已经产生了一种简单的数学语言来阐明因果关系，这使得我们能够清楚的表达我们知道的和我们想知道的。用数学形式表达这些信息的能力提供了大量强大而有原则的方法，用于将我们的知识与数据结合起来，并回答如上五个因果问题。 在过去的25年里，我很幸运地成为了这一科学发展的一部分。我看到它在学生们的小隔间和研究实验室里成形，我听到它的突破在远离公众关注的科学会议上引起共鸣。现在,我们进入强人工智能(AI)的时代，许多人也在吹捧大数据和人工智能中无限的可能性，我发现向读者介绍一些新科学正在走的最冒险的道路是及时和令人兴奋的，以及它如何影响数据科学，和它将在21世纪如何多元的改变我们的生活。 当您听到我将这些成就描述为“新科学”时，您可能会持怀疑态度。您甚至可能会问：“这么久的时间里，为什么以前没人做？”，比如说维吉尔第一次宣称“幸运的是，他能够理解事物的原因”（公元前29年）。或者说是当现代统计学的创始人弗朗西斯·高尔顿和卡尔·皮尔森首次发现人口数据可以阐明科学问题时。他们不幸的未能提出这一科学雏形的背后有一个漫长的故事，这与本书的历史部分有关。但在我看来，最严重的障碍是我们用来回答因果问题的词汇和我们用来交流科学理论的传统词汇之间有着根本差距。 为了能更形象的体会这种隔阂,想象一下科学家们如何去尝试解释一种非常常见的物理因果关系:弹簧的长度B和其所受到的拉力P. 我们能够非常容易的写下这个关系式:B=kPB=kPB=kP，其中kkk代表某种线性比例常数，我们可以使用代数规则将这个表达式更改为许多种表达方式，比方说P=B/kP=B/kP=B/k,k=B/Pk=B/Pk=B/P,或者B−kP=0B-kP=0B−kP=0。这些式子都代表一个规律：式中如果我们知道2个参数的值，则能够得到第3个参数的值。k,B,Pk,B,Pk,B,P这三个值在式中是平权的，没有哪个有优先级的区别。那么问题来了，我们是怎么有信心确保是拉力PPP让弹簧变长的，而不是某种其他的力？更进一步来说，如果这种这么简单的关系我们都不能解释，那么对于其他更加复杂的、无法用数学式描述的因果事物我们就更难解释了，比方说“太阳到底是不是因为公鸡打鸣才升起来的？” 我的大学导师没能够解决这个问题（也从没有抱怨），我也敢打赌说读者你们也从没有想过这个问题。我们现在知道为什么了：从来没有人用因果的数学语言来解释这些现象;这么做也没有展现出来什么好处。事实上，经过了这么多代，仍然没有发明一种这样的语言是一件很悲哀的事情。每个人都知道，按下开关会导致灯的开启或关闭，炎热闷热的夏日午后会导致当地冰淇淋店的销量上升。那么为什么科学家们没有发明一种方式来解释这种现象？就像他们在光学、化学或是几何学中一样？为什么他们放任这些现象的存在，忽略了这种能够让其他学科蓬勃发展的新学科的可能性？ 部分原因是科学工具往往是为了适应对应的学科而发展起来的。恰恰是因为我们太擅长于处理上述的“开关电灯、冰淇淋、气压计”这些问题，我们对于能够用精确的数学语言来描述这些事情的需求不是非常明显。但是随着科学所涉及的领域不断增大，我们也开始在复杂的法律、商业、医疗和政治决策下发现因果问题的需求，结果发现在处理这些问题的时候，我们缺少一种成熟的科学应该提供的工具和方法。 这种科学与需求的延迟在历史中并不少见。举个例子，直到400多年之前，人们都认为自己能够凭直觉的处理生活中的各种不确定性，比如自己能否渡过一条河、能否打赢一场架……这种情况一直持续到了一群赌徒发明了一些复杂的随机游戏为止，这些游戏中有着精心设计的规则会误导我们在游戏中做出坏的选择，一些科学家们： Blaise Pascal (1654), Pierre de Fermat (1654), 和Christiaan Huygens (1657)才发现我们需要一门科学的语言来解决这些问题，这门语言在今天被称作“概率论”。同样的，只有在保险公司需要精确的养老保险金的金额时，数学家们： Edmond Halley(1693) 和 Abraham de Moivre (1725) 才开始计算平均寿命的期望。同样的，天文学家们对于精确天体运动的需求才推进了 Jacob Bernoulli, Pierre-Simon Laplace, 和Carl Friedrich Gauss这些科学家们进行噪声中提取信号的研究。这些都是如今“统计学”的前身。 讽刺的是，对因果关系理论的需求在统计学出现的同时开始显现。事实上，现代的统计学的源头来自于Galton 和 Pearson 的遗传研究中的因果问题，他们巧妙的使用跨代数据来解释这些问题。不幸的是，他们的尝试失败了，但是他们并没有停下来思考失败的原因，反而回避了这些问题，转而投身进了另一个欣欣向荣，并且没有这些复杂的因果关系的行业——“统计”。 这在整个科学领域中是一个重要的临界点，他们本来有一个用自己的语言来装备因果关系问题的机会，但却被浪费了。接下来的几年内这些问题都被看做是与科学无关的，并逐渐被忽略了。尽管遗传学家Sewall Wright(1889-1988)做出了巨大的努力，但在半个多世纪的时间里，用于描述因果的词汇是被禁止的。而当你禁止语言时，你就同时遏制了相关的思想、原则、方法和工具。 读者不必是科学家也能看到这条禁令。在统计学101课程中，每个学生都学会反复背诵:“相关性不是因果关系。”这么做当然是有原因的！早上公鸡打鸣与日出高度相关，但它不是日出的原因。 不幸的是，统计学将这一常见的关系给盲目的模糊化了。它告诉我们相关性不是因果关系，但它没有告诉我们因果关系是什么。在统计学相关的教科书中搜索“原因”这个关键词是徒劳的。学生不能说X是Y的原因，只能说X和Y是“有关系的”或“相关的”。 由于这一\"禁令\"的存在，人们认为没有必要使用一门新的数学语言来分析因果关系，而统计学只关注于如何总结数据，而不是如何解释它。一个引人注目的例外是通径分析(Path Analysis)，它是由遗传学家Sewall Wright在20世纪20年代发明的，也是我们将在本书中介绍的方法的鼻祖。然而，通径分析在统计学及其相关领域中被严重低估，在其萌芽状态下被冷落了几十年。它本应是因果推断革命的第一步，但是直到20世纪80年代，它仍然是仅存的一步。在其他的统计学科中，包括许多以通径分析为指导的学科，仍处于“禁令”的影响之下，错误地认为所有科学问题的答案都存在于数据中，可以通过巧妙的数据挖掘技巧得到。 在今天，这种“信奉”数据为核心的历史仍然困扰着我们。在这个时代中，我们认为大数据能够解决任何问题。我们的大学中“大数据”这种课程正在激增，“数据科学家”们能够在操作“数据经济”的公司里赚上大笔的钱。但我希望通过这本书能让你知道，迷信大数据是极其愚蠢的。数据可以告诉你，吃药的人比不吃药的人恢复得快，但这种分析并不能告诉你原因。也许那些服用药物的人这样做，只是因为他们可以负担得起，当他们没有服用特定药物时，可能也会恢复的一样快（懂王：我曾在极度愤怒的情况下，15秒内痊愈了新冠病毒）。 在各种领域中，我们曾见到过数据不充足的情况。大多数大数据爱好者，虽然多少意识到这些限制，但是仍然继续追逐以数据为中心的只能，好像我们仍处于上述的“禁令”时代。 正如我前面提到的，在过去的30年里，情况发生了巨大的变化。如今，凭借着精心设计的因果模型，当代科学家可以解决那些曾经被认为是无法解决的问题，甚至包括一些超出科学领域之外的问题。例如，就在一百年前，人们还认为“吸烟有害健康”是个伪命题。只要一提到“原因”或“结果”，任何有声望的统计杂志上人们就会立马炸开锅。 即使就是在20年前，如果你问一名统计学家“我的头痛好了是阿斯匹灵的效果吗?”就好像是在问他是否相信巫术。用我一位受人尊敬的同事的话来说，这“更像是茶话会上谈论的话题，而不是科学探究”。但如今，流行病学家、社会科学家、计算机科学家，以及一些开明的经济学家和统计学家经常提出这样的问题，并以精确的数学语言来回答它们。对我来说，这种变化简直就是一场革命。我敢称之为“因果革命”，一场迎接我们关于理解因果的先天认知天赋的科学变革。 因果革命不是凭空产生的；它背后深藏着一个美妙的数学规律，这种规律语言可以很好地对应为因果关系的演算，它解决了一些在因果关系中非常难的问题。我很激动能率先揭开这种规律，不仅因为它的发展历史曲折动荡，更因为我期待有一天它的全部潜力会被人们开发出来，甚至能够超出我的想象……这些人也许是正在读这本书的你们。 因果演算由两种语言组成:因果图，用来表示我们所知道的信息，另一种是一种类似代数的符号语言，用来表示我们想要知道的。因果图是由简单的点和箭头构成的图，总结了我们现有的科学知识。圆点表示感兴趣的数量，称为“变量”，箭头表示这些变量之间已知或可能的因果关系————也就是说，哪个变量“监听”了哪个变量。这些图表非常容易绘制、理解和使用，读者将会在本书中找到几十个这样的图表。如果你会使用单行道地图来进行导航，那么你就能理解因果关系图、就能解决本文开头提到的那些问题。 尽管因果图是我在这本书中选择的工具，但是在我过去35年的研究中，它们并不是唯一可行的因果模型。一些科学家(例如计算经济学家)喜欢试用数学方程式进行相关的研究;其他人(例如硬核统计学家)更喜欢一份表面上概括了图表结构的假设列表。无论使用何种语言，模型都应该描述生成数据的过程(无论效果如何)————换句话说，能够具体的将因果关系的作用体现在数据生成的过程当中。 除了这种图解式的“知识语言”，我们还有一种符号性的“询问语言”来表达我们想要询问的问题。举例来说，如果我们像研究药品DDD和寿命LLL之间的关系，那么我们的问题就能够用一种数学表达式来描述：P(L∣do(D))P(L|do(D))P(L∣do(D))，翻译成人话：当一个标准的病人服用药DDD之后能够活过LLL年的概率是多少？这个问题描述了流行病学家口中所说的干预或治疗，也符合我们在临床试验中所需要测量的东西。在很多情况下，我们也想将P(L∣do(D))P(L|do(D))P(L∣do(D))和P(L∣do(not−D))P(L|do(not-D))P(L∣do(not−D))进行比较，后者描述了拒绝治疗的病人，也被称为“控制组”病人。“do”符号表示我们是在主动的进行干预，而不是被动观察;经典统计中没有任何与之相似的符号。 我们必须使用一个主动干预的符号P(L∣do(D))P(L|do(D))P(L∣do(D))，以确保观察到的寿命LLL变化是由于药物本身，而不是与其他的能够干预寿命的因素相混淆。如果我们不干预，而是让病人自己决定是否服用这种药物，那些其他因素可能会影响他的决定，服用和不服用这种药物之间的寿命差异将不再仅仅是由于这种药物。例如，假设只有那些病入膏肓的病人才服用这种药物。这些人肯定与未服药的人不同，对这两组的比较反映的是他们疾病的严重程度，而不是药物的效果。相比之下，无论先决条件如何，强迫病人服用或不服用这种药物，将消除先前存在的差异，将这种比较变的更加明显。 "}}